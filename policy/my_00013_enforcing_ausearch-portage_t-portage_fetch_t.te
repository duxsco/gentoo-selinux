#----
#time->Sat Apr 30 05:13:12 2022
#type=PROCTITLE msg=audit(1651288392.563:20): proctitle=6770672D636F6E6E6563742D6167656E74002D2D686F6D65646972002F746D702F67656D61746F2E33686C6E776E687A002D73002D2D6E6F2D6175746F737461727400474554494E464F207363645F72756E6E696E67002F696620247B2120243F7D00736364206B696C6C736364002F656E64
#type=PATH msg=audit(1651288392.563:20): item=0 name="/tmp/gemato.3hlnwnhz/S.gpg-agent" inode=25 dev=00:38 mode=0140700 ouid=0 ogid=0 rdev=00:00 obj=staff_u:object_r:portage_tmp_t nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0
#type=CWD msg=audit(1651288392.563:20): cwd="/root/policy"
#type=SOCKADDR msg=audit(1651288392.563:20): saddr=01002F746D702F67656D61746F2E33686C6E776E687A2F532E6770672D6167656E74
#type=SYSCALL msg=audit(1651288392.563:20): arch=c000003e syscall=42 success=no exit=-13 a0=3 a1=7fff217de6b0 a2=22 a3=0 items=1 ppid=5991 pid=5993 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=1 comm="gpg-connect-age" exe="/usr/bin/gpg-connect-agent" subj=staff_u:sysadm_r:portage_t key=(null)
#type=AVC msg=audit(1651288392.563:20): avc:  denied  { connectto } for  pid=5993 comm="gpg-connect-age" path="/tmp/gemato.3hlnwnhz/S.gpg-agent" scontext=staff_u:sysadm_r:portage_t tcontext=staff_u:sysadm_r:portage_fetch_t tclass=unix_stream_socket permissive=0
#----
#time->Sat Apr 30 05:13:12 2022
#type=PROCTITLE msg=audit(1651288392.563:21): proctitle=6770672D636F6E6E6563742D6167656E74002D2D686F6D65646972002F746D702F67656D61746F2E33686C6E776E687A002D2D6E6F2D6175746F7374617274004B494C4C4147454E54
#type=PATH msg=audit(1651288392.563:21): item=0 name="/tmp/gemato.3hlnwnhz/S.gpg-agent" inode=25 dev=00:38 mode=0140700 ouid=0 ogid=0 rdev=00:00 obj=staff_u:object_r:portage_tmp_t nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0
#type=CWD msg=audit(1651288392.563:21): cwd="/root/policy"
#type=SOCKADDR msg=audit(1651288392.563:21): saddr=01002F746D702F67656D61746F2E33686C6E776E687A2F532E6770672D6167656E74
#type=SYSCALL msg=audit(1651288392.563:21): arch=c000003e syscall=42 success=no exit=-13 a0=3 a1=7fffd6631120 a2=22 a3=0 items=1 ppid=5991 pid=5994 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=1 comm="gpg-connect-age" exe="/usr/bin/gpg-connect-agent" subj=staff_u:sysadm_r:portage_t key=(null)
#type=AVC msg=audit(1651288392.563:21): avc:  denied  { connectto } for  pid=5994 comm="gpg-connect-age" path="/tmp/gemato.3hlnwnhz/S.gpg-agent" scontext=staff_u:sysadm_r:portage_t tcontext=staff_u:sysadm_r:portage_fetch_t tclass=unix_stream_socket permissive=0

policy_module(my_00013_enforcing_ausearch-portage_t-portage_fetch_t, 1.0)

gen_require(`
  type portage_fetch_t;
  type portage_t;
')

allow portage_t portage_fetch_t:unix_stream_socket connectto;
